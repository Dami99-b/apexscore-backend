<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ApexScore – Global Risk Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gradient-to-br from-slate-900 via-gray-900 to-black text-white">

<header class="p-5 flex justify-between items-center border-b border-white/10">
  <h1 class="text-2xl font-black tracking-wide">ApexScore</h1>
  <input id="searchInput" placeholder="Search email…" class="px-3 py-2 rounded text-black w-64">
</header>

<div class="p-6 overflow-x-auto">
<table class="w-full text-sm">
<thead>
<tr class="text-gray-400 border-b border-white/10">
<th>Email</th><th>Name</th><th>Phone</th><th>ISP</th><th>City</th><th>Score / Risk</th>
</tr>
</thead>
<tbody id="table"></tbody>
</table>
</div>

<script>
const API = "https://apexscore.onrender.com";
let data = [];

function load() {
 fetch(`${API}/api/applicants?limit=50`)
 .then(r=>r.json())
 .then(d=>{
  data=d.applicants;
  render();
 });
}

function render(){
 const t=document.getElementById("table");
 t.innerHTML="";
 data.forEach(a=>{
  const tr=document.createElement("tr");
  tr.className="border-b border-white/10 hover:bg-white/5 cursor-pointer";
  tr.onclick=()=>alert(JSON.stringify(a,null,2));
  tr.innerHTML=`
   <td>${a.email}</td>
   <td>${a.name.full}</td>
   <td>${a.phone}</td>
   <td>${a.network.isp}</td>
   <td>${a.location.city}</td>
   <td>${a.apex_score} – ${a.risk_level}</td>
  `;
  t.appendChild(tr);
 });
}

document.getElementById("searchInput").addEventListener("keydown",e=>{
 if(e.key==="Enter"){
  fetch(`${API}/api/search?email=${e.target.value}`)
  .then(r=>r.json())
  .then(a=>{
    data.unshift(a);
    render();
  });
 }
});

load();
setInterval(load,3000);
</script>

</body>
</html>
